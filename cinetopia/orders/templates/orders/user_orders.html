{% extends "cinema/base.html" %}
{% load static %}

{% block title %}
  –ú–æ–∏ –∑–∞–∫–∞–∑—ã | üéüÔ∏èCinetopia
{% endblock %}
{% block head %}
  <link rel="stylesheet" href="{% static "orders/css/user_orders.css" %}">
{% endblock %}
{% block main %}
  <main>
    <div class="account-content">
      <h1 class="account-title">–ú–æ–∏ –∑–∞–∫–∞–∑—ã</h1>

      {% if orders %}
        <div class="orders-list">
          {% for order in orders %}
            <div class="order-card">
              <div class="order-header">
                <div class="order-number">
                  –ó–∞–∫–∞–∑ #{{ order.id }}
                </div>
                <div class="order-date">
                  {{ order.created|date:"d.m.Y" }}
                </div>
                <div class="order-status {{ order.status }}">
                  {{ order.get_status_display }}
                </div>
              </div>

              <div class="order-body">
                <div class="order-items-preview">
                  {% for item in order.items.all|slice:":3" %}
                    <div class="order-item-preview">
                      <span class="order-item-name">{{ item.product.name }}</span>
                      <span class="order-item-quantity">{{ item.quantity }} √ó {{ item.price }} ‚ÇΩ</span>
                    </div>
                  {% endfor %}
                  {% if order.items.count > 3 %}
                    <div class="order-more-items">
                      –∏ –µ—â—ë {{ order.items.count|add:"-3" }} —Ç–æ–≤–∞—Ä(–æ–≤)
                    </div>
                  {% endif %}
                </div>

                <div class="order-footer">
                  <div class="order-total">
                    –ò—Ç–æ–≥–æ: <span>{{ order.get_total_cost }} ‚ÇΩ</span>
                  </div>
                  <a href="{% url 'order_detail' order.pk %}" class="order-detail-link">
                    –ü–æ–¥—Ä–æ–±–Ω–µ–µ
                  </a>
                </div>
              </div>
            </div>
          {% endfor %}
        </div>
      {% else %}
        <div class="empty-orders">
          <p>–£ –≤–∞—Å –ø–æ–∫–∞ –Ω–µ—Ç –∑–∞–∫–∞–∑–æ–≤</p>
          <a href="{% url 'shop' %}" class="btn-primary">
            –ü–µ—Ä–µ–π—Ç–∏ –≤ –º–∞–≥–∞–∑–∏–Ω
          </a>
        </div>
      {% endif %}
    </div>
  </main>
{% endblock %}